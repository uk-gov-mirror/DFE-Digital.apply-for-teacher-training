<% content_for :title, t('page_titles.subject_knowledge') %>
<% content_for :before_content, govuk_back_link_to(candidate_interface_application_form_path, 'Back to application') %>

<h1 class="govuk-heading-xl">
  <%= t('page_titles.subject_knowledge') %>
</h1>

<% if @application_form.subject_knowledge_review_pending? %>
  <div class='govuk-inset-text govuk-!-width-two-thirds govuk-!-margin-top-0'>
    <h2 class="govuk-heading-m">Feedback from previous applications</h2>

    <% @application_form.subject_knowledge_rejection_reasons.each do |rejection_reason| %>
      <h3 class="govuk-heading-s govuk-!-margin-bottom-2"><%= rejection_reason.provider_name %></h3>
      <blockquote class="govuk-!-margin-left-0 govuk-!-margin-top-0">
        <p class="govuk-body">“<%= rejection_reason.feedback %>”</p>
      </blockquote>
    <% end %>
  </div>
<% end %>

<%= render(CandidateInterface::SubjectKnowledgeReviewComponent.new(application_form: @application_form)) %>

<%= render(CandidateInterface::CompleteSectionComponent.new(
  application_form: @application_form,
  path: candidate_interface_subject_knowledge_complete_path,
  request_method: :patch,
  field_name: :subject_knowledge_completed,
  section_review: @application_form.subject_knowledge_reviewable?,
)) %>
